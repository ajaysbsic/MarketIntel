## Plan: Technology Intelligence Module

Add a new Technology Market Intelligence view that aggregates existing news/reports through keyword tags, with server-side filters (keyword, time window, region, source type) and new API endpoints for overview, trend timeline, regional heatmap, key players, and AI insights. Scope now includes frontend + API + watcher ingestion changes. Technology focus is stored as keyword tags on news/reports. Outputs include overview + trend timeline + key players, regional heatmap, and AI insights panel. Filters include keyword/time, region, and source type (news/reports now; patents/tenders as placeholders for future ingestion).

**Steps**
1. Define data contract for technology intelligence queries and responses: extend filter DTOs to include `TechnologyKeywords` and `SourceType` while keeping backward compatibility in [Alfanar.MarketIntel.Application/DTOs/NewsFilterDto.cs](Alfanar.MarketIntel.Application/DTOs/NewsFilterDto.cs#L1-L13) and [Alfanar.MarketIntel.Application/DTOs/ReportFilterDto.cs](Alfanar.MarketIntel.Application/DTOs/ReportFilterDto.cs#L1-L20); add new response DTOs under Alfanar.MarketIntel.Application/DTOs/ for overview, timeline, region counts, key players, and insights.
2. Add server-side aggregation endpoints: create a Technology Intelligence controller under Alfanar.MarketIntel.Api/Controllers/ (new file) or extend [Alfanar.MarketIntel.Api/Controllers/MetricsController.cs](Alfanar.MarketIntel.Api/Controllers/MetricsController.cs#L1-L150) with endpoints for overview, trends, region heatmap, key players, and AI insights; wire through [Alfanar.MarketIntel.Application/Services/NewsService.cs](Alfanar.MarketIntel.Application/Services/NewsService.cs#L1-L200) and [Alfanar.MarketIntel.Application/Services/ReportService.cs](Alfanar.MarketIntel.Application/Services/ReportService.cs#L360-L460) using repository aggregation methods in [Alfanar.MarketIntel.Infrastructure/Repositories/NewsRepository.cs](Alfanar.MarketIntel.Infrastructure/Repositories/NewsRepository.cs#L1-L170) and [Alfanar.MarketIntel.Infrastructure/Repositories/FinancialReportRepository.cs](Alfanar.MarketIntel.Infrastructure/Repositories/FinancialReportRepository.cs#L1-L200).
3. Persist keyword tags and source type if missing: confirm `Tags` and source type presence in [Alfanar.MarketIntel.Domain/Entities/NewsArticle.cs](Alfanar.MarketIntel.Domain/Entities/NewsArticle.cs#L1-L33) and [Alfanar.MarketIntel.Domain/Entities/FinancialReport.cs](Alfanar.MarketIntel.Domain/Entities/FinancialReport.cs#L1-L120); add fields and a migration in [Alfanar.MarketIntel.Infrastructure/Persistence/MarketIntelDbContext.cs](Alfanar.MarketIntel.Infrastructure/Persistence/MarketIntelDbContext.cs#L1-L210) to support filtering/aggregation.
4. Update watchers to tag technology keywords at ingestion time: add keyword extraction to [python_watcher/src/rss_watcher.py](python_watcher/src/rss_watcher.py#L1-L200) and [python_watcher/src/report_watcher_v3.py](python_watcher/src/report_watcher_v3.py#L1-L200), then include tags in the payload mapping in [python_watcher/src/api_client.py](python_watcher/src/api_client.py#L1-L80); keep the initial keyword list in a config file (e.g., STATCOM, HVDC, grid stabilization, fast EV charging) for easy tuning.
5. Update API ingest DTOs and mapping so tags are stored: extend [Alfanar.MarketIntel.Application/DTOs/IngestNewsRequest.cs](Alfanar.MarketIntel.Application/DTOs/IngestNewsRequest.cs#L1-L12) and [Alfanar.MarketIntel.Application/DTOs/IngestReportRequest.cs](Alfanar.MarketIntel.Application/DTOs/IngestReportRequest.cs#L1-L27), then map in [Alfanar.MarketIntel.Application/Services/NewsService.cs](Alfanar.MarketIntel.Application/Services/NewsService.cs#L1-L200) and [Alfanar.MarketIntel.Application/Services/ReportService.cs](Alfanar.MarketIntel.Application/Services/ReportService.cs#L1046-L1138).
6. Update the dashboard API client: add methods in [Alfanar.MarketIntel.Dashboard/src/app/shared/services/api.service.ts](Alfanar.MarketIntel.Dashboard/src/app/shared/services/api.service.ts#L1-L180) for the new endpoints and filter payloads.
7. Build the new dashboard module: add a Technology Market Intelligence page, route, and nav entry in [Alfanar.MarketIntel.Dashboard/src/app/app.routing.ts](Alfanar.MarketIntel.Dashboard/src/app/app.routing.ts#L1-L33) and [Alfanar.MarketIntel.Dashboard/src/app/app.component.ts](Alfanar.MarketIntel.Dashboard/src/app/app.component.ts#L10-L84); implement UI sections for overview, timeline, regional heatmap, key players, and insights with filters, following patterns from [Alfanar.MarketIntel.Dashboard/src/app/modules/news/news.component.ts](Alfanar.MarketIntel.Dashboard/src/app/modules/news/news.component.ts#L1-L120) and [Alfanar.MarketIntel.Dashboard/src/app/modules/reports/reports.component.ts](Alfanar.MarketIntel.Dashboard/src/app/modules/reports/reports.component.ts#L1-L140).
8. Document the new module and watcher tagging in [docs/DASHBOARD_UI_GUIDE.md](docs/DASHBOARD_UI_GUIDE.md#L1-L120), [docs/DASHBOARD_UI_IMPLEMENTATION.md](docs/DASHBOARD_UI_IMPLEMENTATION.md#L1-L120), and a watcher note alongside existing watcher docs.

**Verification**
- API: run existing API tests or `dotnet test`, then hit new endpoints via Swagger to validate filters and aggregation outputs.
- Watchers: run a local dry-run with a STATCOM keyword set and confirm tags appear in ingest payloads.
- UI: `npm test` if present, and manual smoke test of filters, charts, and insights.

**Decisions**
- Scope: frontend + API + watcher ingestion changes.
- Taxonomy: technology focus is stored as keyword tags on news/reports.
- Outputs: overview + trend timeline + key players + regional heatmap + AI insights.
- Filters: keyword/time, region, source type (news/reports now; patents/tenders as future-ready values).

If you want me to further refine the watcher keyword taxonomy or define exact aggregation metrics for the heatmap and key players, I can update the draft.
