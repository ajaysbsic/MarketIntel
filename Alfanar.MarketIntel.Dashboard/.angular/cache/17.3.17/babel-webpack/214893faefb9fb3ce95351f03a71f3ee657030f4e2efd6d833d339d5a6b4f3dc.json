{"ast":null,"code":"import { Observable, throwError, of } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport { environment } from '../../../environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport let ApiService = /*#__PURE__*/(() => {\n  class ApiService {\n    constructor(http) {\n      this.http = http;\n      this.apiUrl = environment.apiUrl;\n    }\n    // News Articles\n    getNewsArticles(page = 1, pageSize = 10, search) {\n      let url = `${this.apiUrl}/api/news?page=${page}&pageSize=${pageSize}`;\n      if (search) {\n        url += `&search=${encodeURIComponent(search)}`;\n      }\n      return this.http.get(url).pipe(catchError(this.handleError));\n    }\n    getArticleSentiment(sentiment) {\n      return this.http.get(`${this.apiUrl}/api/news/sentiment/${sentiment}`).pipe(catchError(this.handleError));\n    }\n    // Reports\n    getFinancialReports(page = 1, pageSize = 10) {\n      return this.http.get(`${this.apiUrl}/api/reports?page=${page}&pageSize=${pageSize}`).pipe(catchError(this.handleError));\n    }\n    // Alerts\n    getSmartAlerts(status) {\n      let url = `${this.apiUrl}/api/alerts/recent`;\n      if (status) {\n        url += `?status=${status}`;\n      }\n      return this.http.get(url).pipe(catchError(error => {\n        // Return empty array if alerts endpoint not available\n        console.warn('Alerts endpoint not available:', error);\n        return of([]);\n      }));\n    }\n    acknowledgeAlert(alertId) {\n      return this.http.put(`${this.apiUrl}/api/alerts/${alertId}/acknowledge`, {}).pipe(catchError(this.handleError));\n    }\n    resolveAlert(alertId) {\n      return this.http.put(`${this.apiUrl}/api/alerts/${alertId}/resolve`, {}).pipe(catchError(this.handleError));\n    }\n    // RSS Feeds\n    getRssFeeds(active) {\n      let url = `${this.apiUrl}/api/feeds`;\n      if (active !== undefined) {\n        url += `?isActive=${active}`;\n      }\n      return this.http.get(url).pipe(catchError(this.handleError));\n    }\n    createRssFeed(feed) {\n      return this.http.post(`${this.apiUrl}/api/feeds`, feed).pipe(catchError(this.handleError));\n    }\n    updateRssFeed(id, feed) {\n      return this.http.put(`${this.apiUrl}/api/feeds/${id}`, feed).pipe(catchError(this.handleError));\n    }\n    deleteRssFeed(id) {\n      return this.http.delete(`${this.apiUrl}/api/feeds/${id}`).pipe(catchError(this.handleError));\n    }\n    // Metrics\n    getFinancialMetrics() {\n      return this.http.get(`${this.apiUrl}/api/metrics`).pipe(catchError(this.handleError));\n    }\n    getMetricTrends(company, metric) {\n      return this.http.get(`${this.apiUrl}/api/metrics/${company}/${metric}/trends`).pipe(catchError(this.handleError));\n    }\n    // Dashboard - Aggregate data from existing endpoints\n    getDashboardSummary() {\n      return new Observable(subscriber => {\n        Promise.all([this.getFinancialReports(1, 1000).toPromise().catch(() => ({\n          items: []\n        })), this.getNewsArticles(1, 1000).toPromise().catch(() => ({\n          items: []\n        })), this.getSmartAlerts().toPromise().catch(() => [])]).then(([reports, news, alerts]) => {\n          const summary = {\n            totalReports: reports?.items?.length || 0,\n            totalArticles: news?.items?.length || 0,\n            activeAlerts: (alerts || []).filter(a => a.status !== 'resolved').length,\n            averageSentiment: this.calculateAverageSentiment([...(reports?.items || []).map(r => r.sentimentScore), ...(news?.items || []).map(n => n.sentimentScore)]),\n            positiveSentiment: [...(reports?.items || []), ...(news?.items || [])].filter(item => (item.sentimentScore || 0) > 0.3).length,\n            neutralSentiment: [...(reports?.items || []), ...(news?.items || [])].filter(item => Math.abs(item.sentimentScore || 0) <= 0.3).length,\n            negativeSentiment: [...(reports?.items || []), ...(news?.items || [])].filter(item => (item.sentimentScore || 0) < -0.3).length,\n            topKeywords: []\n          };\n          subscriber.next(summary);\n          subscriber.complete();\n        }).catch(error => {\n          console.error('Error loading dashboard summary:', error);\n          subscriber.next({\n            totalArticles: 0,\n            totalReports: 0,\n            activeAlerts: 0,\n            averageSentiment: 0,\n            positiveSentiment: 0,\n            neutralSentiment: 0,\n            negativeSentiment: 0,\n            topKeywords: []\n          });\n          subscriber.complete();\n        });\n      });\n    }\n    calculateAverageSentiment(sentiments) {\n      if (sentiments.length === 0) return 0;\n      return sentiments.reduce((a, b) => a + b, 0) / sentiments.length;\n    }\n    // Conversational AI\n    queryConversationalAI(query, context) {\n      return this.http.post(`${this.apiUrl}/api/ai/query`, {\n        query,\n        context\n      }).pipe(catchError(this.handleError));\n    }\n    // Contact Form Submission\n    submitContactForm(data) {\n      return this.http.post(`${this.apiUrl}/api/contactform/submit`, data).pipe(catchError(this.handleError));\n    }\n    getContactForms(page = 1, pageSize = 20) {\n      return this.http.get(`${this.apiUrl}/api/contactform?page=${page}&pageSize=${pageSize}`).pipe(catchError(this.handleError));\n    }\n    getContactFormById(id) {\n      return this.http.get(`${this.apiUrl}/api/contactform/${id}`).pipe(catchError(this.handleError));\n    }\n    getUnreadContactForms() {\n      return this.http.get(`${this.apiUrl}/api/contactform/unread`).pipe(catchError(this.handleError));\n    }\n    // Company Contact Information\n    getCompanyContact(company = 'alfanar') {\n      return this.http.get(`${this.apiUrl}/api/companycontact/${company}`).pipe(catchError(this.handleError));\n    }\n    getCompanyContactInfo(company = 'alfanar') {\n      return this.http.get(`${this.apiUrl}/api/companycontact/${company}/info`).pipe(catchError(this.handleError));\n    }\n    getCompanyOffices(company = 'alfanar') {\n      return this.http.get(`${this.apiUrl}/api/companycontact/${company}/offices`).pipe(catchError(this.handleError));\n    }\n    getOfficesByRegion(region) {\n      return this.http.get(`${this.apiUrl}/api/companycontact/offices/region/${region}`).pipe(catchError(this.handleError));\n    }\n    handleError(error) {\n      console.error('API Error:', error);\n      let errorMessage = 'An error occurred. Please try again.';\n      if (error.error instanceof ErrorEvent) {\n        errorMessage = `Error: ${error.error.message}`;\n      } else if (error.status) {\n        errorMessage = `Error: ${error.status} - ${error.statusText}`;\n      }\n      return throwError(() => new Error(errorMessage));\n    }\n    static {\n      this.ɵfac = function ApiService_Factory(t) {\n        return new (t || ApiService)(i0.ɵɵinject(i1.HttpClient));\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: ApiService,\n        factory: ApiService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return ApiService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}